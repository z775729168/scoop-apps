{
  "version": "1.2.5",
  "description": "Jarvis is a tool designed to manipulate robot locations within the 3D simulation software called Process Simulate. With this app, users can easily control and modify the positions of robots in the virtual environment using convenient keyboard shortcuts. By interacting with the app, users can trigger movements, rotations, or adjustments to the robots' positions in real-time, enabling precise control and manipulation of their locations within the simulation. This app enhances the user experience by providing a streamlined and efficient way to modify robot positions, making it easier to simulate and optimize various industrial processes.",
  "homepage": "https://icarus-consult.de",
  "license": "non-free",
  "url": "//promptly-apps.icarus-consult.local/Software/TMXTOOLS/jarvis/1.2.5/Jarvis 1.2.5.msi",
  "autoupdate": {
    "url": "//promptly-apps.icarus-consult.local/Software/TMXTOOLS/jarvis/$version/Jarvis $version.msi"
  },
  "pre_install": [
    "if(Get-Process -Name \"tune\" -ErrorAction SilentlyContinue) {",
    "    Write-Error \"Process Simulate is running. Please close it to continue.\"",
    "    exit 1",
    " }",
    "$FileName = \"C:\\ProgramData\\Jarvis\\keyboard.xml\"",
    "if (Test-Path $FileName) {",
    "$userJarvisDirectory = [System.Environment]::ExpandEnvironmentVariables($env:USERPROFILE) + \"\\Jarvis\"",
    "[System.IO.Directory]::CreateDirectory($userJarvisDirectory)",
    "Move-Item $FileName -Destination $userJarvisDirectory -Force",
    "Write-host $FileName \" has been copied to backup your shortcut settings.\"",
    "}"
  ],
  "post_install": [
    "# Copy to emPower Directory",
    "$emPowerDir = \"\";",
    "if(Test-Path -Path 'HKLM:\\SOFTWARE\\TecnomatixRoot') {",
    "        Write-Host Shared Tecnomatix is installed",
    "        $shared = Get-ItemPropertyValue -Path 'HKLM:\\SOFTWARE\\TecnomatixRoot\\' -Name SymbolicLinkLocation",
    "        $emPowerDir = $shared + \"TecnomatixCurrent\\eMPower\"",
    "        if(!(Test-Path -Path $emPowerDir)) {",
    "               $emPowerDir = Get-ItemPropertyValue -Path 'HKLM:\\SOFTWARE\\Tecnomatix\\eMPower' -Name eMPowerDir",
    "        }",
    "} elseif(Test-Path -Path 'HKLM:\\SOFTWARE\\Tecnomatix\\eMPower') {",
    "        Write-Host Single Tecnomatix is installed",
    "        $emPowerDir = Get-ItemPropertyValue -Path 'HKLM:\\SOFTWARE\\Tecnomatix\\eMPower' -Name eMPowerDir",
    "} else {",
    "        Write-Host Could not find a valid Tecnomatix Installation",
    "}",
    "Write-Host \"Tecnomatix detected at \" $emPowerDir",
    "$xmls = $original_dir + \"\\ProgramFiles64Folder\\Tecnomatix\\eMPower\\DotNetExternalApplications\"",
    "Copy-Item $xmls -Destination $eMPowerDir -Force -Recurse",
    "$cmds = $original_dir + \"\\ProgramFiles64Folder\\Tecnomatix\\eMPower\\DotNetCommands\"",
    "Copy-Item $cmds -Destination $eMPowerDir -Force -Recurse",
    "",
    "# Copy Config Files",
    "[System.IO.Directory]::CreateDirectory('C:\\ProgramData\\Jarvis')",
    "$configDir = $original_dir + \"\\ABSOLUTEPATH1\\*\"",
    "Copy-Item $configDir -Destination \"C:\\ProgramData\\Jarvis\" -Force -Recurse",
    "# Copy App Files",
    "[System.IO.Directory]::CreateDirectory('C:\\ProgramData\\Jarvis\\app')",
    "$app = $original_dir + \"\\ABSOLUTEPATH\\*\"",
    "Copy-Item $app -Destination \"C:\\ProgramData\\Jarvis\\app\" -Force -Recurse"
  ],
  "pre_uninstall": [
    "if(Get-Process -Name \"tune\" -ErrorAction SilentlyContinue) {",
    "    Write-Error \"Process Simulate is running. Please close it to continue.\"",
    "    exit 1",
    " }",
    "$FileName = \"C:\\ProgramData\\Jarvis\\keyboard.xml\"",
    "if (Test-Path $FileName) {",
    "$userJarvisDirectory = [System.Environment]::ExpandEnvironmentVariables($env:USERPROFILE) + \"\\Jarvis\"",
    "[System.IO.Directory]::CreateDirectory($userJarvisDirectory)",
    "Move-Item $FileName -Destination $userJarvisDirectory -Force",
    "Write-host $FileName \" has been copied to backup your shortcut settings.\"",
    "}"
  ],
  "post_uninstall": [
    "# Copy to emPower Directory",
    "$emPowerDir = \"\";",
    "if(Test-Path -Path 'HKLM:\\SOFTWARE\\TecnomatixRoot') {",
    "        Write-Host Shared Tecnomatix is installed",
    "        $shared = Get-ItemPropertyValue -Path 'HKLM:\\SOFTWARE\\TecnomatixRoot\\' -Name SymbolicLinkLocation",
    "        $emPowerDir = $shared + \"TecnomatixCurrent\\eMPower\"",
    "        if(!(Test-Path -Path $emPowerDir)) {",
    "               $emPowerDir = Get-ItemPropertyValue -Path 'HKLM:\\SOFTWARE\\Tecnomatix\\eMPower' -Name eMPowerDir",
    "        }",
    "} elseif(Test-Path -Path 'HKLM:\\SOFTWARE\\Tecnomatix\\eMPower') {",
    "        Write-Host Single Tecnomatix is installed",
    "        $emPowerDir = Get-ItemPropertyValue -Path 'HKLM:\\SOFTWARE\\Tecnomatix\\eMPower' -Name eMPowerDir",
    "} else {",
    "        Write-Host Could not find a valid Tecnomatix Installation",
    "}",
    "Write-Host \"Tecnomatix detected at \" $emPowerDir",
    "$cmd = $emPowerDir + \"\\DotNetCommands\\Jarvis\"",
    "Remove-Item -Recurse -Force $cmd",
    "$xml = $emPowerDir + \"\\DotNetExternalApplications\\Jarvis.xml\"",
    "Remove-Item -Recurse -Force $xml",
    "# Remove Config Files",
    "Remove-Item -Recurse -Force C:\\ProgramData\\Jarvis"
  ]
}